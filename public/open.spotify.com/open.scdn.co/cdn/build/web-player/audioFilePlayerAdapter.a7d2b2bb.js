(("undefined"!=typeof self?self:global).webpackJsonp=("undefined"!=typeof self?self:global).webpackJsonp||[]).push([[7],{MAGf:function(e,t,r){"use strict";r.r(t),r.d(t,"createAudioFilePlayerAdapter",(function(){return _}));r("FdtR"),r("9UJh");var n=r("OvAC"),a=r.n(n),i=r("junw"),o=r("cnbf");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const u={paused:!0,context:{uri:null,metadata:{}},duration:0,position:0,shuffle:!1,repeat_mode:i.c.OFF,timestamp:0,disallows:{},restrictions:{},track_window:{current_track:null,next_tracks:[],previous_tracks:[]}};var d;!function(e){e[e.UPDATE=0]="UPDATE"}(d||(d={}));const l=Object(o.e)(((e=u,t)=>{switch(t.type){case d.UPDATE:return c(c({},e),t.newPartialState);default:return e}})),p=e=>{l.dispatch({type:d.UPDATE,newPartialState:e})};var m=r("qG8n"),y=r.n(m),b=r("wJTk"),f=r.n(b),k=r("uEU3");function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const O=1e3,E=(e,t,r)=>{if("undefined"!=typeof document){const t=document.querySelector("body");if(t){const r=()=>{e.load(),t.removeEventListener("click",r)};t.addEventListener("click",r)}}var n;"undefined"!=typeof window&&window.addEventListener("beforeunload",(()=>{r.onPlaybackEnded(k.b.REQUESTED,e.currentTime)})),e.addEventListener("playing",(()=>{p({paused:!1}),r.onResumed(e.currentTime)})),e.addEventListener("pause",(()=>{p({paused:!0}),r.onPaused(e.currentTime)})),e.addEventListener("timeupdate",(e=>{t.emit(i.a.PROGRESS,{data:{position:e.target.currentTime*O}})})),e.addEventListener("ended",(()=>{r.onPlaybackEnded(k.b.PLAYED_TO_END,e.currentTime)})),e.addEventListener("canplay",(()=>{t.emit(i.a.BUFFERING_END,void 0),r.onReady(e.currentTime)})),e.addEventListener("waiting",(()=>{t.emit(i.a.BUFFERING_START,void 0),r.onBuffering(k.a.STALL,e.currentTime)})),e.addEventListener("error",(n=>{var a;const o=null==n||null===(a=n.target)||void 0===a?void 0:a.error;let s;if(null!=o&&o.code){switch(o.code){case 1:s="Problem fetching the track";break;case 2:s="Network error";break;case 3:s="Error decoding the track";break;case 4:s="Unable to play the track";break;default:s="Unknown audio playback error"}t.emit(i.a.ERROR,{error:w(w({},o),{},{code:null==o?void 0:o.code,message:s})}),r.onPlaybackEnded(k.b.FATAL_ERROR,e.currentTime)}})),n=e=>{t.emit(i.a.STATE_CHANGED,e)},l.subscribe((()=>n(l.getState())))},_=(e,t)=>{const r=new y.a;return setTimeout((()=>{try{if(!e)throw new Error("Audio element not found");E(e,r,t)}catch(e){throw r.emit(i.a.PLAYER_INITIALIZATION_FAILED,{error:e}),e}}),0),{async play(r,{metadata:n,offset:a}){const i=n;if(!i)return Promise.reject("No audio file URL. :(");const o=({name:e,uri:t})=>({name:e,uri:t}),s=i.id||f.a.from(i.uri)._base62Id;var c;(p({track_window:{current_track:{id:s,uri:i.uri,type:i.type,name:i.name||"",media_type:"audio",duration_ms:i.duration_ms,album:i.album&&(({uri:e,name:t,images:r,artists:n})=>({uri:e,name:t,images:r,artists:n&&n.map(o)||[],linked_from:{id:null,uri:null}}))(i.album),artists:i.artists&&i.artists.map(o)},next_tracks:[],previous_tracks:[]},paused:!1,disallows:{skipping_next:!0,skipping_prev:!0},restrictions:{disallow_skipping_next_reasons:["unauthenticated_user"],disallow_skipping_prev_reasons:["unauthenticated_user"]},context:i.context}),e.src!==i.unencrypted_playback_url)?(t.onPlaybackCreated({mediaUrl:i.uri,sessionId:btoa(Math.random().toString()),context:(null===(c=i.album)||void 0===c?void 0:c.uri)||""},e.currentTime),e.src=i.unencrypted_playback_url||"",a&&a>=0&&i.duration_ms&&a<i.duration_ms&&(e.currentTime=a/O)):a&&await this.seek(a);return e.play(),!0},async resume(){try{return e.play(),!0}catch(e){return!1}},async pause(){try{return e.pause(),!0}catch(e){return!1}},async togglePlay(){return e.paused?this.resume():this.pause()},seek:async r=>(t.onSeeking(e.currentTime,r/O),e.currentTime=r/O,Promise.resolve(!0)),seekForward:async r=>(t.onSeeking(e.currentTime,r/O),e.currentTime+=r/O,Promise.resolve(!0)),seekBackward:async r=>(t.onSeeking(e.currentTime,r/O),e.currentTime-=r/O,Promise.resolve(!0)),on(e,t,n){r.on(e,t,n)},removeListener(e,t){r.removeListener(e,t)}}}}}]);
//# sourceMappingURL=audioFilePlayerAdapter.a7d2b2bb.js.map